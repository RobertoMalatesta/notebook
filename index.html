<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="description" content="量化金融 - 武统台湾，留岛不留人 - quantitative finance in javascript">
    <meta name="author" content="Jin Yang">
    <meta name="keywords" content="quantlib.js, 量化金融, 金融, notebook, math, javascript, quant, quantitative, finance, quantitative finance, mathematical finance">
    <meta name="google-site-verification" content="4IrXoRzLpuCL684J3Y19wWtY9W5KqlvwLH5EQuZh1-Q" />
    <meta name="baidu-site-verification" content="5VJ5ngbcQy" />
    <title>勿謂言之不預也！ © 2020 Jin Yang</title>
    <link rel="shortcut icon" type="image/png" href="/cn.png">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@forevolve/bootstrap-dark@1.0.0-alpha.981/dist/css/toggle-bootstrap.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@forevolve/bootstrap-dark@1.0.0-alpha.981/dist/css/toggle-bootstrap-dark.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/codemirror@5.52.2/lib/codemirror.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/codemirror@5.52.2/theme/base16-light.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/codemirror@5.52.2/theme/base16-dark.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.css" />
        
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-87290595-6"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-87290595-6');
    </script>
    <script>
      var _hmt = _hmt || [];
      (function() {
        var hm = document.createElement("script");
        hm.src = "https://hm.baidu.com/hm.js?fe6b934f326cc497985add8efde0653d";
        var s = document.getElementsByTagName("script")[0]; 
        s.parentNode.insertBefore(hm, s);
      })();
    </script>
    <style>
      .CodeMirror {
        height: auto;
      }
      .cell.row{
        border-color: #191d21;
        border-width: 0.5px;
        border-style: solid;
        padding: 2px;
        margin: 2px;
        border-radius: 0.5em;
      }
      body {
        position: relative;

      }
      body::-webkit-scrollbar { width: 0 !important }
      .input {
        padding-top: 2px;
      }
      .running {
        padding-right: 2px;
      }
      #toc {
        top: 56px;
        left: 20px;
      }
      nav[data-toggle="toc"] .nav > li > a {
        display: block;
        padding: 4px 20px;
        font-size: 16px;
        font-weight: 500;
        color: #767676;
      }
      nav[data-toggle="toc"] .nav > li > a:hover,
      nav[data-toggle="toc"] .nav > li > a:focus {
        padding-left: 19px;
        color: #563d7c;
        text-decoration: none;
        background-color: transparent;
        border-left: 1px solid #563d7c;
      }
      nav[data-toggle="toc"] .nav-link.active,
      nav[data-toggle="toc"] .nav-link.active:hover,
      nav[data-toggle="toc"] .nav-link.active:focus {
        padding-left: 18px;
        font-weight: bold;
        color: #563d7c;
        background-color: transparent;
        border-left: 2px solid #563d7c;
      }
      nav[data-toggle="toc"] .nav-link + ul {
        display: none; /* Hide by default, but at >768px, show it */
        padding-bottom: 10px;
      }
      nav[data-toggle="toc"] .nav .nav > li > a {
        padding-top: 1px;
        padding-bottom: 1px;
        padding-left: 30px;
        font-size: 14px;
        font-weight: normal;
      }
      nav[data-toggle="toc"] .nav .nav > li > a:hover,
      nav[data-toggle="toc"] .nav .nav > li > a:focus {
        padding-left: 29px;
      }
      nav[data-toggle="toc"] .nav .nav > li > .active,
      nav[data-toggle="toc"] .nav .nav > li > .active:hover,
      nav[data-toggle="toc"] .nav .nav > li > .active:focus {
        padding-left: 28px;
        font-weight: 500;
      }
      nav[data-toggle="toc"] .nav-link.active + ul {
        display: block;
      }
      blockquote {
        border-left: 4px solid #DDD;
        padding: 0 15px;
        color: #777;
      }
    </style>
  </head>
  <body class="bootstrap-dark" data-spy="scroll" data-target="#toc" data-offset="56">
    <nav class="navbar sticky-top navbar-expand-xl navbar-themed">
      <div id="spinners">
        <div class="spinner-grow text-primary" role="status">
          <span class="sr-only">Loading...</span>
        </div>
        <div class="spinner-grow text-secondary" role="status">
          <span class="sr-only">Loading...</span>
        </div>
        <div class="spinner-grow text-success" role="status">
          <span class="sr-only">Loading...</span>
        </div>
        <div class="spinner-grow text-danger" role="status">
          <span class="sr-only">Loading...</span>
        </div>
        <div class="spinner-grow text-warning" role="status">
          <span class="sr-only">Loading...</span>
        </div>
        <div class="spinner-grow text-info" role="status">
          <span class="sr-only">Loading...</span>
        </div>
        <div class="spinner-grow text-light" role="status">
          <span class="sr-only">Loading...</span>
        </div>
        <div class="spinner-grow text-dark" role="status">
          <span class="sr-only">Loading...</span>
        </div>
      </div>
      <div id="toolbar" class="container-fluid">
        <a class="navbar-brand" href="/notebook">quantlib.js</a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarSupportedContent">
          <ul class="navbar-nav mr-auto">
            <li class="nav-item">
              <a class="nav-link" onclick="add('javascript', selected);"><i class="fa fa-plus"></i></a>
            </li>
            <li class="nav-item">
              <a class="nav-link" onclick="run(selected);"><i class="fa fa-play"></i></a>
            </li>
            <li class="nav-item">
              <a class="nav-link" onclick="clearCell(selected);"><i class="fa fa-times-circle-o"></i></a>
            </li>
            <li class="nav-item">
              <a class="nav-link" onclick="runUp();"><i class="fa fa-angle-double-up"></i></a>
            </li>
            <li class="nav-item">
              <a class="nav-link" onclick="runDown();"><i class="fa fa-angle-double-down"></i></a>
            </li>
            <li class="nav-item">
              <a class="nav-link" onclick="runAll();"><i class="fa fa-forward"></i></a>
            </li>
            <li class="nav-item">
              <a class="nav-link" onclick="clearAll();"><i class="fa fa-close"></i></a>
            </li>
            <li class="nav-item">
              <a class="nav-link" target="_blank" href="/notebook/#tutorial.en.json">教程 <i class="fa fa-external-link"></i></a>
            </li>
            <li class="nav-item">
              <a class="nav-link" target="_blank" href="/docs">文档 <i class="fa fa-external-link"></i></a>
            </li>
            <li class="nav-item">
              <a class="nav-link" target="_blank" href="/test-suite">测试 <i class="fa fa-external-link"></i></a>
            </li>
          </ul>
          <form class="form-inline">
            <div class="custom-control custom-checkbox">
              <input type="checkbox" class="custom-control-input" id="nextcell">
              <label class="custom-control-label" for="nextcell"></label>
            </div>
            <div class="custom-control custom-switch">
              <input type="checkbox" class="custom-control-input" id="switchengine">
              <label class="custom-control-label" for="switchengine"></label>
            </div>
            <ul class="navbar-nav">
              <li class="nav-item">
                <a class="nav-link" onclick="select(NaN);"><i id="browser"></i></a>
              </li>
              <li class="nav-item">
                <a class="nav-link" onclick="toggleLock();"><i id="lock" class="fa fa-unlock-alt"></i></a>
              </li>
              <li class="nav-item">
                <a class="nav-link" onclick="toggleTS();"><i id="usets" class="fa fa-toggle-off"></i></a>
              </li>
              <li class="nav-item">
                <a class="nav-link" onclick="toggleToc();"><i id="layout" class="fa fa-columns"></i></a>
              </li>
              <li class="nav-item">
                <a class="nav-link" onclick="color();"><i class="fa fa-adjust"></i></a>
              </li>
              <li class="nav-item">
                <a class="nav-link" onclick="$('#file-input').click();"><i class="fa fa-upload"></i></a>
              </li>
              <li class="nav-item">
                <a class="nav-link" onclick="saveAs($('#filename').val(),toJSON());"><i class="fa fa-download"></i></a>
              </li>
            </ul>
            <input class="form-control" id="filename" type="search" placeholder="武统台湾.json">
          </form>
        </div>
      </div>
    </nav>
    <div class="container-fluid">
      <div class="row no-gutters" id="root">
        <div id="tocroot" class="col-xl-2 hidden-lg-down">
          <nav id="toc" class="sticky-top" data-toggle="toc"></nav>
        </div>
        <div id="nbroot" class="col-lg-12 col-xl-12">
          <div id="notebook" class="container-fluid"></div>
        </div>
      </div>
    </div>
    <input type="file" id="file-input" style="display: none;">
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.4.1/dist/jquery.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@forevolve/bootstrap-dark@1.0.0-alpha.981/dist/js/bootstrap.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/codemirror@5.52.2/lib/codemirror.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/codemirror@5.52.2/mode/javascript/javascript.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/codemirror@5.52.2/mode/markdown/markdown.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked@0.8.2/marked.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/highcharts@8.0.4/highcharts.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/highcharts@8.0.4/modules/stock.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/highcharts@8.0.4/modules/exporting.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/highcharts@8.0.4/modules/offline-exporting.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/highcharts@8.0.4/modules/export-data.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.js"></script>
    <script>
    window.cookieconsent.initialise({
      "palette": {
        "popup": {
          "background": "#aa0000",
          "text": "#ffdddd"
        },
        "button": {
          "background": "#ff0000"
        }
      },
      "position": "bottom-right"
    });
    </script>
    <script>var file,appSize,counter=0,cells={},theme="dark",color_enter="#C1E0FF",light_leave="#ffffff",dark_leave="#191d21",selected=NaN,offset=55,engine="eval5",useTS=!1,reader=new FileReader,default_file="武统台湾.json",nextcell=!0,scrollcell=!1,locked=!1,dirty=!1,show_toc=!1,history={},tapped=!1,mobile=/android|webos|iphone|ipad|ipod|blackberry|iemobile|opera mini/i.test(navigator.userAgent.toLowerCase()),wechat=/MicroMessenger/.test(navigator.userAgent),HCDefaults=$.extend(!0,{},Highcharts.getOptions(),{}),dart_chart={colors:["#2b908f","#90ee7e","#f45b5b","#7798BF","#aaeeee","#ff0066","#eeaaee","#55BF3B","#DF5353","#7798BF","#aaeeee"],chart:{backgroundColor:{linearGradient:{x1:0,y1:0,x2:1,y2:1},stops:[[0,"#2a2a2b"],[1,"#3e3e40"]]},style:{fontFamily:"'Unica One', sans-serif"},plotBorderColor:"#606063"},title:{style:{color:"#E0E0E3",fontSize:"20px"}},subtitle:{style:{color:"#E0E0E3"}},xAxis:{gridLineColor:"#707073",labels:{style:{color:"#E0E0E3"}},lineColor:"#707073",minorGridLineColor:"#505053",tickColor:"#707073",title:{style:{color:"#A0A0A3"}}},yAxis:{gridLineColor:"#707073",labels:{style:{color:"#E0E0E3"}},lineColor:"#707073",minorGridLineColor:"#505053",tickColor:"#707073",tickWidth:1,title:{style:{color:"#A0A0A3"}}},tooltip:{backgroundColor:"rgba(0, 0, 0, 0.85)",style:{color:"#F0F0F0"}},plotOptions:{series:{dataLabels:{color:"#F0F0F3",style:{fontSize:"13px"}},marker:{lineColor:"#333"}},boxplot:{fillColor:"#505053"},candlestick:{lineColor:"white"},errorbar:{color:"white"}},legend:{backgroundColor:"rgba(0, 0, 0, 0.5)",itemStyle:{color:"#E0E0E3"},itemHoverStyle:{color:"#FFF"},itemHiddenStyle:{color:"#606063"},title:{style:{color:"#C0C0C0"}}},credits:{style:{color:"#666"}},labels:{style:{color:"#707073"}},drilldown:{activeAxisLabelStyle:{color:"#F0F0F3"},activeDataLabelStyle:{color:"#F0F0F3"}},navigation:{buttonOptions:{symbolStroke:"#DDDDDD",theme:{fill:"#505053"}}},rangeSelector:{buttonTheme:{fill:"#505053",stroke:"#000000",style:{color:"#CCC"},states:{hover:{fill:"#707073",stroke:"#000000",style:{color:"white"}},select:{fill:"#000003",stroke:"#000000",style:{color:"white"}}}},inputBoxBorderColor:"#505053",inputStyle:{backgroundColor:"#333",color:"silver"},labelStyle:{color:"silver"}},navigator:{handles:{backgroundColor:"#666",borderColor:"#AAA"},outlineColor:"#CCC",maskFill:"rgba(255,255,255,0.1)",series:{color:"#7798BF",lineColor:"#A6C7ED"},xAxis:{gridLineColor:"#505053"}},scrollbar:{barBackgroundColor:"#808083",barBorderColor:"#808083",buttonArrowColor:"#CCC",buttonBackgroundColor:"#606063",buttonBorderColor:"#606063",rifleColor:"#FFF",trackBackgroundColor:"#404043",trackBorderColor:"#404043"}},worker=new Worker("worker.js");function color(){"dark"===theme?(theme="light",$(".row").css("border-color",light_leave),resetChartTheme()):(theme="dark",$(".row").css("border-color",dark_leave),resetChartTheme(),Highcharts.setOptions(dart_chart)),$("body").removeClass();var e="dark"===theme?"bootstrap-dark":"bootstrap";for(id in $("body").addClass(e),cells)cells[id].setOption("theme",`base16-${theme}`);$(`#cell${selected}`).find(".btn-group").show(),$(`#cell${selected}`).css({"border-color":color_enter})}function setTheme(e){"light"===(theme=e)?$(".row").css("border-color",light_leave):$(".row").css("border-color",dark_leave),$("body").removeClass();var t="dark"===theme?"bootstrap-dark":"bootstrap";for(id in $("body").addClass(t),cells)cells[id].setOption("theme",`base16-${theme}`);$(`#cell${selected}`).find(".btn-group").show(),$(`#cell${selected}`).css({"border-color":color_enter})}function getEditor(e,t,o=!1){var n=document.getElementById(e);return CodeMirror.fromTextArea(n,{theme:`base16-${theme}`,lineWrapping:!0,mode:t,readOnly:o})}function toggle(e){locked||("javascript"===cells[e].options.mode?cells[e].setOption("mode","markdown"):cells[e].setOption("mode","javascript"),$(`#celltype${e}`).toggleClass("fa-sticky-note-o"),$(`#celltype${e}`).toggleClass("fa-code"),$("#celltype").toggleClass("fa-sticky-note-o"),$("#celltype").toggleClass("fa-code"))}function eye(e){$(`#in${e}`).is(":visible")?$(`#in${e}`).hide():($(`#in${e}`).show(),setTimeout((function(){cells[e].refresh()}),10))}function hideEditor(e){$(`#in${e}`).is(":visible")&&$(`#in${e}`).hide()}function add(e,t=NaN){if(!locked){var o=counter++,n=`<div id="cell${o}" class="cell row no-gutters" ${mobile?'ontouchstart="select2(':'onclick="select('}${o});" ${mobile?"":'ondblclick="eye('+o+');"'}>\n<div class="col-xl-1 hidden-lg-down px-0">\n<div class="btn-group pull-right" role="group">\n  <button type="button" class="btn btn-sm" onclick="toggle(${o})"><i id="celltype${o}" class="${"javascript"===e?"fa fa-code":"fa fa-sticky-note-o"}"></i></button>\n  <button type="button" class="btn btn-sm" onclick="add('javascript', ${o});"><i class="fa fa-plus"></i></button>\n  <button type="button" class="btn btn-sm" onclick="run(${o});"><i class="fa fa-play"></i></button>\n</div>\n</div>\n<div class="col-lg-12 col-xl-10 px-0">\n<div id="in${o}" class="input"><textarea id="edit${o}"></textarea></div>\n<div id="out${o}"></div>\n</div>\n<div class="col-xl-1 hidden-lg-down px-0">\n<div class="btn-group" role="group">\n  <button type="button" class="btn btn-sm" onclick="moveUp(${o});"><i class="fa fa-angle-up"></i></button>\n  <button type="button" class="btn btn-sm" onclick="del(${o});"><i class="fa fa-trash-o"></i></button>\n  <button type="button" class="btn btn-sm" onclick="moveDown(${o});"><i class="fa fa-angle-down"></i></button>\n</div>\n</div>\n</div>`;isNaN(t)?$("#notebook").append(n):$(n).insertAfter(`#cell${t}`);var l=getEditor(`edit${o}`,e);cells[o]=l,$(`#cell${o} .btn-group`).hide(),$(`#cell${o}`).css({"border-color":"dark"===theme?dark_leave:light_leave})}}function del(e){locked||confirm("Delete this cell?")&&(event.stopPropagation(),$(`#cell${e}`).remove(),delete cells[e],e==selected&&(selected=NaN))}function moveUp(e){locked||$(`#cell${e}`).insertBefore($(`#cell${e}`).prev(".row"))}function moveDown(e){locked||$(`#cell${e}`).insertAfter($(`#cell${e}`).next(".row"))}function toJSON(){var e={};e.setting={interpreter:engine,typescript:useTS,locked:locked,toc:show_toc,color:theme},e.notebook={};for(var t=$("#notebook .row"),o=0;o<t.length;o++){var n=t[o].id.substr(4),l={};l.input={type:cells[n].options.mode,source:cells[n].getValue()},l.show_editor=$(`#in${n}`).is(":visible"),l.output={type:"html",content:$(`#out${n}`).html()},e.notebook[`${t[o].id}`]=l}return JSON.stringify(e,null,"\t")}function saveAs(e,t){""==e&&(e=default_file);var o=document.createElement("a");o.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(t)),o.setAttribute("download",e),o.style.display="none",document.body.appendChild(o),o.click(),document.body.removeChild(o)}function fromJSON(e){for(cell in cells=[],counter=0,selected=NaN,"eval5"==(engine=e.setting.interpreter)?$("#switchengine").prop("checked",!0):$("#switchengine").prop("checked",!1),useTS!=e.setting.typescript&&($("#usets").toggleClass("fa-toggle-on"),$("#usets").toggleClass("fa-toggle-off")),useTS=e.setting.typescript,locked!=e.setting.locked&&($("#lock").toggleClass("fa-lock"),$("#lock").toggleClass("fa-unlock-alt")),locked=e.setting.locked,show_toc!=e.setting.toc&&toggleToc(),show_toc=e.setting.toc,theme!=e.setting.color&&color(),theme=e.setting.color,$("#notebook").empty(),e.notebook){var t=parseInt(cell.substr(4),10);counter<t&&(counter=t);var o=e.notebook[cell].input.type,n="javascript"===o?"fa fa-code":"fa fa-sticky-note-o";$("#notebook").append(`<div id="cell${t}" class="cell row no-gutters" ${mobile?'ontouchstart="select2(':'onclick="select('}${t});" ${mobile?"":'ondblclick="eye('+t+');"'}>\n<div class="col-xl-1 hidden-lg-down px-0">\n<div class="btn-group pull-right" role="group">\n  <button type="button" class="btn btn-sm" onclick="toggle(${t})"><i id="celltype${t}" class="${n}"></i></button>\n  <button type="button" class="btn btn-sm" onclick="add('javascript', ${t});"><i class="fa fa-plus"></i></button>\n  <button type="button" class="btn btn-sm" onclick="run(${t});"><i class="fa fa-play"></i></button>\n</div>\n</div>\n<div class="col-lg-12 col-xl-10 px-0">\n<div id="in${t}" class="input"><textarea id="edit${t}"></textarea></div>\n<div id="out${t}">${e.notebook[cell].output.content}</div>\n</div>\n<div class="col-xl-1 hidden-lg-down px-0">\n<div class="btn-group" role="group">\n  <button type="button" class="btn btn-sm" onclick="moveUp(${t});"><i class="fa fa-angle-up"></i></button>\n  <button type="button" class="btn btn-sm" onclick="del(${t});"><i class="fa fa-trash-o"></i></button>\n  <button type="button" class="btn btn-sm" onclick="moveDown(${t});"><i class="fa fa-angle-down"></i></button>\n</div>\n</div>\n</div>`);var l=getEditor(`edit${t}`,o,locked);l.setValue(e.notebook[cell].input.source),setTimeout((function(){l.refresh()}),10),cells[t]=l,e.notebook[cell].show_editor||eye(t)}$(".btn-group").hide(),$(".cell.row").css({"border-color":"dark"===theme?dark_leave:light_leave}),hover(),counter++,updateToc(),updateInternalLink()}function select(e){selected!=e&&($(`#cell${selected}`).find(".btn-group").hide(),$(`#cell${selected}`).css({"border-color":"dark"===theme?dark_leave:light_leave}),$(`#cell${selected}`).css({"border-left-width":"0.5px"}),$(`#cell${selected}`).css({"margin-left":"2px"}),selected=e,"xl"==appSize&&$(`#cell${e}`).find(".btn-group").show(),$(`#cell${e}`).css({"border-color":color_enter}),$(`#cell${e}`).css({"border-left-width":"6px"}),$(`#cell${e}`).css({"margin-left":"-3.5px"}));var t="javascript"==cells[e].options.mode?"fa fa-code":"fa fa-sticky-note-o";$("#celltype").removeClass(),$("#celltype").addClass(t)}function select2(e){select(e),tapped?(clearTimeout(tapped),tapped=null,eye(e)):tapped=setTimeout((function(){tapped=null}),300)}function hover(){$(document).on({mouseenter:function(){"xl"==appSize&&$(this).find(".btn-group").show(),$(this).css({"border-color":color_enter})},mouseleave:function(){$(this).attr("id").substr(4)!=selected&&("xl"==appSize&&$(this).find(".btn-group").hide(),$(this).css({"border-color":"dark"===theme?dark_leave:light_leave}))}},".cell.row")}function readSingleFile(e){(file=e.target.files[0])&&reader.readAsText(file)}function load(e){try{fetch(e).then(e=>e.json()).then(e=>{fromJSON(e)})}catch(e){console.log(e)}}function output(e,t){if(void 0!==e)switch(e.type){case"plot":switch(e.data.hcProduct){case"chart":Highcharts.chart(`ot${t}`,e.data);break;case"stock":Highcharts.stockChart(`ot${t}`,e.data);break;case"map":Highcharts.mapChart(`ot${t}`,e.data);break;case"gantt":Highcharts.ganttChart(`ot${t}`,e.data);break;default:throw new Error("empty or invalid chart type")}hideEditor(t);break;case"table":var o=`${e.data}`;$(`#ot${t}`).append(o);break;case"text":o=`<code>${e.data}</code>`;$(`#ot${t}`).append(o);break;default:smart(e,t)}else if($(`#ot${t}`).is(":empty")){o=`<code>${e}</code>`;$(`#ot${t}`).append(o)}}function smart(e,t){switch(typeof e){case"object":if(e instanceof Date)o=`<code>${e.toLocaleDateString()}</code>`;else if(e instanceof Array)if(e.every(e=>"string"==typeof e))o=`${JSON.stringify(e,null,2)}`;else{if(e.every(e=>"number"==typeof e)){renderVector(e,t);break}if(e.every(e=>e instanceof Array)){renderMatrix(e,t);break}if(e.every(e=>"object"==typeof e)){table(e);break}o=`${JSON.stringify(e,null,2)}`}else o=null!=e.toTex?"$ "+e.toTex()+" $":`<code>${e}</code>`;$(`#ot${t}`).append(o),null!=e.toTex&&latex(t);break;case"function":var o="<code>[Function]</code>";$(`#ot${t}`).append(o);break;default:o=`<code>${e}</code>`;$(`#ot${t}`).append(o)}}function renderVector(e,t){var o="$";o+="\\begin{bmatrix}";for(var n=0;n<e.length;n++)o+=e[n],n!=e.length-1&&(o+="&");o+="\\end{bmatrix}",o+="$",$(`#ot${t}`).append(o),latex(t)}function renderMatrix(e,t){var o="$";o+="\\begin{bmatrix}";for(var n=0;n<e.length;n++){for(var l=0;l<e[0].length;l++)o+=e[n][l],l!=e[n].length-1&&(o+="&");o+="\\\\"}o+="\\end{bmatrix}",o+="$",$(`#ot${t}`).append(o),latex(t)}function print(e,t){var o=`<code>${e}<br></code>`;$(`#ot${t}`).append(o)}function table(e,t){if(!Array.isArray(e))return print(e);var o='<table class="table table-striped">',n=e[0];for(td in o+="<thead><tr>",n)o+=`<th>${td}</th>`;o+="</tr></thead><tbody>";for(var l=0;l<e.length;l++){for(td in o+="<tr>",e[l])o+=`<td>${e[l][td]}</td>`;o+="</tr>"}var r=`${o+="</tbody></table>"}`;$(`#ot${t}`).append(r)}function latex(e){var t=document.getElementById(`ot${e}`);renderMathInElement(t,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1}]})}function run(e){if(!locked&&!isNaN(e)){$(`#out${e}`).empty(),$(`#out${e}`).append(`<div id=ot${e}></div>`);var t=cells[e].getValue();if("javascript"===cells[e].options.mode)$(`#cell${e} button`).prop("disabled",!0),$(`#cell${e} > .col-xl-1`).first().append('<div class="running pull-right">\n<div class="spinner-grow spinner-grow-sm text-primary" role="status">\n<span class="sr-only">Loading...</span>\n</div>\n<div class="spinner-grow spinner-grow-sm text-success" role="status">\n<span class="sr-only">Loading...</span>\n</div>\n<div class="spinner-grow spinner-grow-sm text-danger" role="status">\n<span class="sr-only">Loading...</span>\n</div>\n<div class="spinner-grow spinner-grow-sm text-warning" role="status">\n<span class="sr-only">Loading...</span>\n</div>\n</div>'),worker.postMessage({id:e,source:t,useTS:useTS,engine:engine});else{hideEditor(e);try{var o=protectMath(t);$(`#ot${e}`).append(`${o}`),updateInternalLink(),latex(e)}catch(t){$(`#out${e}`).append(`<pre>${t.message}</pre>`)}}nextcell&&(event.stopPropagation(),next(e)),updateToc()}}function next(e){var t=$(".cell.row"),o=[];for(let e=0;e<t.length;e++){var n=parseInt(t[e].id.substr(4),10);o.push(n)}var l=o.indexOf(e);if(-1!=l&&l!=o.length-1){var r=o[l+1];select(r),scrollcell&&$("html, body").scrollTop($(`#cell${r}`).offset().top-offset)}}function runUp(){if(!locked)for(var e=$("#notebook .row"),t=0;t<e.length;t++){var o=parseInt(e[t].id.substr(4),10);if(o==selected)break;run(o)}}function runDown(){if(!locked){for(var e=$("#notebook .row"),t=[],o=0;o<e.length;o++){var n=parseInt(e[o].id.substr(4),10);t.push(n)}var l=t.indexOf(selected);if(l>-1)for(o=l;o<t.length;o++)run(t[o])}}function runAll(){if(!locked){var e=nextcell;nextcell=!1;for(var t=$("#notebook .row"),o=0;o<t.length;o++){run(t[o].id.substr(4))}nextcell=e}}function runMD(){for(var e=$("#notebook .row"),t=0;t<e.length;t++){var o=e[t].id.substr(4);$(`#celltype${o}`).hasClass("fa-sticky-note-o")&&run(o)}}function updateToc(){if("xl"==appSize){$("#toc").empty();var e=createChildNavList($("#toc")),t=getTopLevel($("#notebook"));populateNav(e,t,getHeadings($("#notebook"),t)),$('[data-spy="scroll"]').each((function(){$(this).scrollspy("refresh")})),$("#toc a").on("click",linkOffset)}}function linkOffset(){event.preventDefault(),$("html, body").scrollTop($($(this).attr("href")).offset().top-offset)}function updateInternalLink(){$("#notebook .internal-link").on("click",linkOffset)}function toggleToc(){$("#tocroot").toggle(),$("#nbroot").toggleClass("col-xl-10"),$("#nbroot").toggleClass("col-xl-12")}function runCode(){for(var e=$("#notebook .row"),t=0;t<e.length;t++){var o=e[t].id.substr(4);$(`#celltype${o}`).hasClass("fa-code")&&run(o)}}function clearAll(){if(!locked){for(var e=$("#notebook .row"),t=0;t<e.length;t++){var o=e[t].id.substr(4);$(`#out${o}`).empty(),$(`#in${o}`).is(":visible")||($(`#in${o}`).show(),setTimeout((function(){cells[o].refresh()}),10))}$("#toc").empty()}}function clearCode(){for(var e=$("#notebook .row"),t=0;t<e.length;t++){var o=e[t].id.substr(4);$(`#celltype${o}`).hasClass("fa-code")&&($(`#out${o}`).empty(),$(`#in${o}`).is(":visible")||$(`#in${o}`).show())}}function clearCell(e){$(`#out${e}`).empty(),$(`#in${e}`).is(":visible")||$(`#in${e}`).show()}function compass(){NaN!=selected&&$("html, body").scrollTop($(`#cell${selected}`).offset().top-offset)}function varlist(){var e=[];for(p in eval5.globalContext)"ql"!=p&&"console"!=p&&"math"!=p&&"plot"!=p&&"print"!=p&&"table"!=p&&e.push({name:p,type:typeof eval5.globalContext[p],value:eval5.globalContext[p]});table(e)}function findOrFilter(e,t){var o=e.find(t);return e.filter(t).add(o).filter(":not([data-toc-skip])")}function createChildNavList(e){var t=$('<ul class="nav navbar-nav"></ul>');return e.append(t),t}function generateNavEl(e,t){var o=$('<a class="nav-link"></a>');o.attr("href","#"+e),o.text(t);var n=$("<li></li>");return n.append(o),n}function generateNavItem(e){var t=e.id,o=$(e);return generateNavEl(t,o.data("toc-text")||o.text())}function getTopLevel(e){for(var t=1;t<=6;t++){if(findOrFilter(e,"h"+t).length>1)return t}return 1}function getHeadings(e,t){return findOrFilter(e,"h"+t+","+("h"+(t+1)))}function getNavLevel(e){return parseInt(e.tagName.charAt(1),10)}function populateNav(e,t,o){var n,l=e;o.each((function(o,r){var a=generateNavItem(r);getNavLevel(r)===t?l=e:n&&l===e&&(l=createChildNavList(n)),l.append(a),n=a}))}function getResponsiveBreakpoint(){var e={xs:"d-none",sm:"d-sm-none",md:"d-md-none",lg:"d-lg-none",xl:"d-xl-none"},t="",o=$("<div>");o.appendTo($("body"));for(var n=Object.keys(e).length-1;n>=0&&(t=Object.keys(e)[n],o.addClass(e[t]),!o.is(":hidden"));n--);return o.remove(),t}worker.onmessage=function(e){var t=e.data.id,o=e.data.result;switch(e.data.fn){case"output":$(`#cell${t} .running`).remove(),$(`#cell${t} button`).prop("disabled",!1),output(o,t);break;case"print":print(o,t);break;case"plot":break;case"table":table(o,t);break;case"oneTimeLoad":oneTimeLoad();break;default:throw new Error("invalid action")}};var tokenType={MARK:0,MASK:1},tokenLiteral={MASK:"::MASK::"};function tokenize(e){for(var t,o,n=["\\\\\\$","\\$\\$(?:[^\\\\]|\\\\.)*?\\$\\$","\\$(?:[^$\\\\]|\\\\.)+?\\$",tokenLiteral.MASK].join("|"),l=new RegExp(n,"g"),r=[],a=0;null!==(t=l.exec(e));)t.index>a&&(o=e.substring(a,t.index),r.push([tokenType.MARK,o])),r.push([tokenType.MASK,t[0]]),a=l.lastIndex;return o=e.substring(a),e.length>a&&r.push([tokenType.MARK,o]),r}function protectMath(e){for(var t=tokenize(e),o="",n=[],l=0;l<t.length;l++)t[l][0]==tokenType.MARK?o+=t[l][1]:(n.push(l),o+=tokenLiteral.MASK);o=marked(o);var r=new RegExp(tokenLiteral.MASK,"g"),a=0;return o=o.replace(r,(function(){return t[n[a++]][1]}))}function detectBrowser(){var e=!!window.opr&&!!opr.addons||!!window.opera||navigator.userAgent.indexOf(" OPR/")>=0,t="undefined"!=typeof InstallTrigger,o=/constructor/i.test(window.HTMLElement)||"[object SafariRemoteNotification]"===(!window.safari||"undefined"!=typeof safari&&safari.pushNotification).toString(),n=!!document.documentMode,l=!n&&!!window.StyleMedia,r=!(!window.chrome||!window.chrome.webstore&&!window.chrome.runtime);r&&navigator.userAgent.indexOf("Edg");e?$("#browser").addClass("fa fa-opera"):t?$("#browser").addClass("fa fa-firefox"):o?$("#browser").addClass("fa fa-safari"):n?$("#browser").addClass("fa fa-internet-explorer"):l?$("#browser").addClass("fa fa-edge"):r?$("#browser").addClass("fa fa-chrome"):$("#browser").addClass("fa fa-mouse-pointer")}function toggleLock(){if(locked)for(id in locked=!1,cells)cells[id].setOption("readOnly",!1);else for(id in locked=!0,cells)cells[id].setOption("readOnly",!0);$("#lock").toggleClass("fa-lock"),$("#lock").toggleClass("fa-unlock-alt")}function toggleTS(){useTS=!useTS,$("#usets").toggleClass("fa-toggle-on"),$("#usets").toggleClass("fa-toggle-off")}function reset(){$("#sandbox")[0].contentWindow.location.reload(!0)}function undo(e){locked||NaN!=selected&&cells[e].undo()}function redo(e){locked||NaN!=selected&&cells[e].redo()}function updatePlot(){for(var e=$(".js-plotly-plot"),t=0;t<e.length;t++)Plotly.update(e[t].id)}function resetChartTheme(){var e=Highcharts.getOptions();for(var t in e)"function"!=typeof e[t]&&delete e[t];Highcharts.setOptions(HCDefaults)}function handleResize(){"xl"==(appSize=getResponsiveBreakpoint())?(runMD(),$(`#cell${selected}`).find(".btn-group").show(),$("#toolbar .navbar-brand").remove(),$("#toolbar").prepend('<a class="navbar-brand" href="/notebook">quantlib.js</a>')):($("#toc").empty(),$(`#cell${selected}`).find(".btn-group").hide(),$("#toolbar .navbar-brand").remove(),$("#toolbar").prepend('<a class="navbar-brand" onclick="add(\'javascript\', selected);"><i class="fa fa-plus"></i></a>\n<a class="navbar-brand" onclick="run(selected);"><i class="fa fa-play"></i></a>\n<a class="navbar-brand" onclick="toggle(selected);"><i id="celltype" class="fa fa-code"></i></a>\n<a class="navbar-brand" onclick="del(selected);"><i class="fa fa-trash-o"></i></a>\n<a class="navbar-brand" onclick="runAll();"><i class="fa fa-forward"></i></a>\n<a class="navbar-brand" onclick="moveUp(selected);"><i class="fa fa-angle-up"></i></a>\n<a class="navbar-brand" onclick="moveDown(selected);"><i class="fa fa-angle-down"></i></a>\n'))}function oneTimeLoad(){var e=window.location.hash;if(""!==e){var t=(e=e.substr(1)).split("/"),o=t[t.length-1];$("#filename").val(o),load(e)}hover(),$("#spinners").remove(),$("#toolbar").show()}function main(){$("#toolbar").hide(),document.getElementById("file-input").addEventListener("change",readSingleFile,!1),document.getElementById("file-input").addEventListener("click",(function(){this.value=null}),!1),document.getElementById("nextcell").addEventListener("change",(function(){nextcell||scrollcell?nextcell&&!scrollcell?($("#nextcell").prop("checked",!0),scrollcell=!0):nextcell&&scrollcell&&($("#nextcell").prop("checked",!1),nextcell=!1,scrollcell=!1):($("#nextcell").prop("indeterminate",!0),nextcell=!0)})),$("#nextcell").prop("indeterminate",!0),document.getElementById("switchengine").addEventListener("change",(function(){engine="eval5"==engine?"evil":"eval5"})),$("#switchengine").prop("checked",!0),$(document).on("dragenter",(function(e){e.stopPropagation(),e.preventDefault()})),$(document).on("dragover",(function(e){e.stopPropagation(),e.preventDefault()})),$(document).on("drop",(function(e){e.preventDefault(),(file=e.originalEvent.dataTransfer.files[0])&&reader.readAsText(file)})),reader.onload=function(e){var t=e.target.result;try{fromJSON(JSON.parse(t)),$("#filename").val(file.name)}catch(e){console.log(e)}finally{file=void 0,t=void 0}},window.addEventListener("resize",handleResize),handleResize();var e=new marked.Renderer;e.link=function(e,t,o){var n=marked.Renderer.prototype.link.apply(this,arguments);return-1==e.indexOf("/")&&-1==e.indexOf(".json")?n.replace("<a","<a class='internal-link'"):n.replace("<a","<a target='_blank'")},marked.setOptions({renderer:e,gfm:!0}),$("#tocroot").hide(),detectBrowser(),Highcharts.setOptions(dart_chart)}$(document).ready((function(){main()}));</script>
  </body>
</html>
